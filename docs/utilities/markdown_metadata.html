

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; CRACMM 3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=110ea713"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Map SPECIATE species to CRACMM" href="SPECIATE_map2cracmm.html" />
    <link rel="prev" title="Map BEIS and MEGAN species to CRACMM" href="BEISMEGAN_biogenicmapping2cracmm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CRACMM
              <img src="../_static/CRACMM_1.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../chemistry/README.html">Chemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emissions/README.html">Emissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metadata/README.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Support utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../emissions/smiles2cracmm.html">Find CRACMM species based on SMILES</a></li>
<li class="toctree-l1"><a class="reference internal" href="BEISMEGAN_biogenicmapping2cracmm.html">Map BEIS and MEGAN species to CRACMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPECIATE_map2cracmm.html">Map SPECIATE species to CRACMM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../additional_info.html">Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional_info.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional_info.html#epa-disclaimer">EPA Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MIT License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CRACMM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/utilities/markdown_metadata.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Mon Sep 12 16:46:56 2022</span>

<span class="sd">@author: phavala</span>

<span class="sd">Updates:</span>
<span class="sd">20240209 Nash Skipper:</span>
<span class="sd">- Remove depracated method pd.DataFrame.append and replace it with pd.concat</span>
<span class="sd">- Explicitly set regex=False in pd.Series.str.replace; the default of regex</span>
<span class="sd">    has changed from True to False in more recent versions of pandas</span>
<span class="sd">- Create output directory if it does not exist</span>
<span class="sd">- Print warning for missing species descriptions</span>
<span class="sd">20240328 Nash Skipper:</span>
<span class="sd">- Output DTXSID to metadata csv file</span>
<span class="sd">- Fix error in initial pd.concat implementation that resulted in no metadata</span>
<span class="sd">    being saved from hlconst, AERO_DEFN, and SOA_DEFN</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># THIS SCRIPT DOES NOT REQUIRE MAIN_CRACMM to be run</span>

<span class="c1"># Creates metadata csv and markdown file for github</span>
<span class="c1"># adapted from AppendixAB_andMD.py from Pye et al. ACPD</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">prep_metadata</span><span class="p">(</span><span class="n">mech</span><span class="p">):</span>
    
    <span class="c1"># uses CMAQ files: AE.nml, GC.nml, NR.nml. AERO_DATA.F, SOA_DEFN.F, hlconst.F, {mech}_speciesdescription.csv</span>
    <span class="c1"># mech input string should be cracmm1_aq or cracmm1amore_aq for CMAQv5.4</span>
    <span class="c1">#                             cracmm1_aq, cracmm1amore_aq, or cracmm2 for CMAQv5.5</span>

    <span class="c1">## Manual selections ###########################################</span>
    <span class="c1"># Set current working directory where this file resides </span>
    <span class="c1"># This python code expects *.nml and files from CMAQ to be present in ../input and will output in ../output</span>
    <span class="n">codedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">codedir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="n">inputfiledir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">&#39;../output&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;../output&#39;</span><span class="p">)</span>

    <span class="c1">###########################################</span>
    <span class="c1"># Prep Gases</span>
    <span class="n">gcfile</span> <span class="o">=</span> <span class="s1">&#39;GC_&#39;</span><span class="o">+</span><span class="n">mech</span><span class="o">+</span><span class="s1">&#39;.nml&#39;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">inputfiledir</span><span class="p">,</span> <span class="n">gcfile</span><span class="p">)</span>
    <span class="n">dfgc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nrowdim</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dfgc</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">nrowdim</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#drop last row</span>
    <span class="n">dfgc</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;!SPECIES&quot;</span><span class="p">:</span><span class="s2">&quot;Species&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;PhaseG&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;G&#39;</span>  <span class="c1"># is it in the gas-phase? </span>
    <span class="n">dfgc</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;GC2AESURR&#39;</span><span class="p">,</span><span class="s1">&#39;GC2AQSURR&#39;</span><span class="p">,</span><span class="s1">&#39;IC&#39;</span><span class="p">,</span><span class="s1">&#39;IC_FAC&#39;</span><span class="p">,</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span><span class="s1">&#39;BC_FAC&#39;</span><span class="p">,</span><span class="s1">&#39;FAC&#39;</span><span class="p">,</span><span class="s1">&#39;CONC&#39;</span><span class="p">,</span><span class="s1">&#39;WDEP&#39;</span><span class="p">,</span><span class="s1">&#39;DDEP&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;VROC&#39;</span><span class="p">,</span><span class="s1">&#39;ROC&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># drop for matching with AE</span>

    <span class="c1">###########################################</span>
    <span class="c1"># Prep NR</span>
    <span class="n">nrfile</span> <span class="o">=</span> <span class="s1">&#39;NR_&#39;</span><span class="o">+</span><span class="n">mech</span><span class="o">+</span><span class="s1">&#39;.nml&#39;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">inputfiledir</span><span class="p">,</span> <span class="n">nrfile</span><span class="p">)</span>
    <span class="n">dfnr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nrowdim</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dfnr</span><span class="p">)</span>
    <span class="n">dfnr</span><span class="o">=</span><span class="n">dfnr</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">nrowdim</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#drop last row</span>
    <span class="n">dfnr</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="n">dfnr</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfnr</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;!SPECIES&quot;</span><span class="p">:</span><span class="s2">&quot;Species&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfnr</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfnr</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfnr</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfnr</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfnr</span><span class="p">[</span><span class="s1">&#39;PhaseG&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;G&#39;</span>
    <span class="n">dfnr</span><span class="o">=</span><span class="n">dfnr</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;NR2AESURR&#39;</span><span class="p">,</span><span class="s1">&#39;NR2AQSURR&#39;</span><span class="p">,</span><span class="s1">&#39;IC&#39;</span><span class="p">,</span><span class="s1">&#39;IC_FAC&#39;</span><span class="p">,</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span><span class="s1">&#39;BC_FAC&#39;</span><span class="p">,</span><span class="s1">&#39;FAC&#39;</span><span class="p">,</span><span class="s1">&#39;CONC&#39;</span><span class="p">,</span><span class="s1">&#39;WDEP&#39;</span><span class="p">,</span><span class="s1">&#39;DDEP&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#these won&#39;t match other nml</span>
    <span class="c1"># Append NR to GC</span>
    <span class="n">dfgc</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfgc</span><span class="p">,</span> <span class="n">dfnr</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;WET-SCAVSURR&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;WET-SCAVSURR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;WET-SCAVSURR&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;WET-SCAVSURR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1">###########################################</span>
    <span class="c1">#https://www.dataquest.io/wp-content/uploads/2019/03/python-regular-expressions-cheat-sheet.pdf</span>
    <span class="c1"># Prep hlconst, dissolution enthalpy for WET-SCAVSURR</span>
    <span class="n">hlfile</span> <span class="o">=</span> <span class="s1">&#39;hlconst.F&#39;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">inputfiledir</span><span class="p">,</span> <span class="n">hlfile</span><span class="p">)</span>
    <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hspecies&#39;</span><span class="p">,</span><span class="s1">&#39;henryMatm&#39;</span><span class="p">,</span><span class="s1">&#39;henryenthalpyK&#39;</span><span class="p">]</span>
    <span class="n">dfhenry</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
    <span class="c1"># read lines that start with DATA SUBNAME (&#39;^       DATA SUBNAME&#39;) and parse Hlconst, save to dataframe</span>
    <span class="n">filetoread</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">filetoread</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;^      DATA SUBNAME\(&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">):</span>
            <span class="n">hspecies</span><span class="o">=</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;\)\s*/\s*</span><span class="se">\&#39;</span><span class="s1">(.*)</span><span class="se">\&#39;</span><span class="s1">.*!&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># return name</span>
            <span class="n">hlvalue</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;DATA SUBNAME.*\/.*,(.*),.*\/.*!&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get the item between the first 2 commas between the slashes</span>
            <span class="n">enthalpyK</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;DATA SUBNAME.*\/.*,.*,(.*).*\/.*!&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">newrow</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hspecies&#39;</span><span class="p">:</span><span class="n">hspecies</span><span class="p">,</span><span class="s1">&#39;henryMatm&#39;</span><span class="p">:</span><span class="n">hlvalue</span><span class="p">,</span>
                                  <span class="s1">&#39;henryenthalpyK&#39;</span><span class="p">:</span><span class="n">enthalpyK</span><span class="p">})</span>
            <span class="n">dfhenry</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfhenry</span><span class="p">,</span> <span class="n">newrow</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfhenry</span><span class="o">.</span><span class="n">hspecies</span><span class="o">=</span><span class="n">dfhenry</span><span class="o">.</span><span class="n">hspecies</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfgc</span><span class="p">,</span><span class="n">dfhenry</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;WET-SCAVSURR&quot;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;hspecies&quot;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

    <span class="c1">###########################################</span>
    <span class="c1"># Prep AE</span>
    <span class="n">aefile</span> <span class="o">=</span> <span class="s1">&#39;AE_&#39;</span><span class="o">+</span><span class="n">mech</span><span class="o">+</span><span class="s1">&#39;.nml&#39;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">inputfiledir</span><span class="p">,</span> <span class="n">aefile</span> <span class="p">)</span>
    <span class="n">dfae</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nrowdim</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dfae</span><span class="p">)</span>
    <span class="n">dfae</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">nrowdim</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#drop last row</span>
    <span class="n">dfae</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># get rid of spaces in column names</span>
    <span class="n">dfae</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;!SPECIES&quot;</span><span class="p">:</span><span class="s2">&quot;Species&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># rename this heading</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># get rid of &#39; in species names</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># get rid of spaces in species names</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;PhaseP&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;P&#39;</span> <span class="c1"># particle phase</span>
    <span class="n">dfae</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;AE2AQSURR&#39;</span><span class="p">,</span><span class="s1">&#39;FAC.1&#39;</span><span class="p">,</span><span class="s1">&#39;IC&#39;</span><span class="p">,</span><span class="s1">&#39;IC_FAC&#39;</span><span class="p">,</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span><span class="s1">&#39;BC_FAC&#39;</span><span class="p">,</span><span class="s1">&#39;FAC&#39;</span><span class="p">,</span><span class="s1">&#39;CONC&#39;</span><span class="p">,</span><span class="s1">&#39;WDEP&#39;</span><span class="p">,</span><span class="s1">&#39;DDEP&#39;</span><span class="p">,</span><span class="s1">&#39;OPTICS&#39;</span><span class="p">,</span><span class="s1">&#39;DRYDEPSURR&#39;</span><span class="p">,</span><span class="s1">&#39;WET-SCAVSURR&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#these won&#39;t match other nml</span>

    <span class="c1">###########################################</span>
    <span class="c1"># Prep AERO_DATA and get density, kappa</span>
    <span class="n">adfile</span> <span class="o">=</span> <span class="s1">&#39;AERO_DATA.F&#39;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">inputfiledir</span><span class="p">,</span> <span class="n">adfile</span><span class="p">)</span>
    <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;adspecies&#39;</span><span class="p">,</span><span class="s1">&#39;aerodensity&#39;</span><span class="p">,</span><span class="s1">&#39;aerokappa&#39;</span><span class="p">]</span>
    <span class="n">dfad</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
    <span class="c1"># read lines that start with DATA SUBNAME (&#39;^       DATA SUBNAME&#39;) and parse Hlconst, save to dataframe</span>
    <span class="n">filetoread</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">filetoread</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;^     &amp; spcs_list_type\(&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">):</span>
            <span class="c1"># one comment has () which is problematic, drop</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;(Black)&#39;</span><span class="p">,</span><span class="s1">&#39;Black&#39;</span><span class="p">)</span>
            <span class="n">adspecies</span><span class="o">=</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; spcs_list_type\(</span><span class="se">\&#39;</span><span class="s1">(.*)</span><span class="se">\&#39;</span><span class="s1">,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># return name</span>
            <span class="n">aerodensity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; spcs_list_type\(.*,.*,.*,.*,.*,\s*(.*),.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
            <span class="n">aerokappa</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; spcs_list_type\(.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,(.*)\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
            <span class="n">newrow</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;adspecies&#39;</span><span class="p">:</span><span class="n">adspecies</span><span class="p">,</span><span class="s1">&#39;aerodensity&#39;</span><span class="p">:</span><span class="n">aerodensity</span><span class="p">,</span>
                                  <span class="s1">&#39;aerokappa&#39;</span><span class="p">:</span><span class="n">aerokappa</span><span class="p">})</span>
            <span class="n">dfad</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfad</span><span class="p">,</span> <span class="n">newrow</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfad</span><span class="o">.</span><span class="n">adspecies</span><span class="o">=</span><span class="n">dfad</span><span class="o">.</span><span class="n">adspecies</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfae</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfae</span><span class="p">,</span><span class="n">dfad</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Species&quot;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;adspecies&quot;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

    <span class="c1">###########################################</span>
    <span class="c1"># Prep SOA_DEFN</span>
    <span class="n">oafile</span> <span class="o">=</span> <span class="s1">&#39;SOA_DEFN.F&#39;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">inputfiledir</span><span class="p">,</span> <span class="n">oafile</span><span class="p">)</span>
    <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;oaspecies&#39;</span><span class="p">,</span><span class="s1">&#39;oacstar&#39;</span><span class="p">,</span><span class="s1">&#39;oaenthalpy&#39;</span><span class="p">,</span><span class="s1">&#39;oaotoc&#39;</span><span class="p">,</span><span class="s1">&#39;oaomoc&#39;</span><span class="p">]</span>
    <span class="n">dfoa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
    <span class="c1"># read lines that start with DATA SUBNAME (&#39;^       DATA SUBNAME&#39;) and parse Hlconst, save to dataframe</span>
    <span class="n">filetoread</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">filetoread</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;^     &amp; oa_type\(&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">):</span>
            <span class="n">oaspecies</span><span class="o">=</span><span class="p">(</span>      <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; oa_type\(</span><span class="se">\&#39;</span><span class="s1">(.*)</span><span class="se">\&#39;</span><span class="s1">,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># return name</span>
            <span class="n">oacstar</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span>   <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; oa_type\(.*,.*,.*,.*,\s*(.*),.*,.*,.*,.*,.*,.*,.*\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
            <span class="n">oaenthalpy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; oa_type\(.*,.*,.*,.*,.*,\s*(.*),.*,.*,.*,.*,.*,.*\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
            <span class="n">oaotoc</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span>    <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; oa_type\(.*,.*,.*,.*,.*,.*,\s*(.*),.*,.*,.*,.*,.*\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
            <span class="n">oaomoc</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span>  <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;^     &amp; oa_type\(.*,.*,.*,.*,.*,.*,.*,\s*(.*),.*,.*,.*,.*\)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 
            <span class="n">newrow</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;oaspecies&#39;</span><span class="p">:</span><span class="n">oaspecies</span><span class="p">,</span><span class="s1">&#39;oacstar&#39;</span><span class="p">:</span><span class="n">oacstar</span><span class="p">,</span>
                                  <span class="s1">&#39;oaenthalpy&#39;</span><span class="p">:</span><span class="n">oaenthalpy</span><span class="p">,</span><span class="s1">&#39;oaotoc&#39;</span><span class="p">:</span><span class="n">oaotoc</span><span class="p">,</span>
                                   <span class="s1">&#39;oaomoc&#39;</span><span class="p">:</span><span class="n">oaomoc</span><span class="p">})</span>
            <span class="c1">#print(newrow)</span>
            <span class="n">dfoa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfoa</span><span class="p">,</span> <span class="n">newrow</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfoa</span><span class="o">.</span><span class="n">oaspecies</span><span class="o">=</span><span class="n">dfoa</span><span class="o">.</span><span class="n">oaspecies</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfae</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfae</span><span class="p">,</span><span class="n">dfoa</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Species&quot;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;oaspecies&quot;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

    <span class="c1"># Finish formatting ae.nml info</span>
    <span class="c1">#dfae[&#39;Species&#39;]=dfae[&#39;Species&#39;].str.strip().str[0:-1] # remove trailing I,J,K, needed for CMAQ v5.3 but not v5.4</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AROC&#39;</span><span class="p">,</span><span class="s1">&#39;ROC&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># match these with gas</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AHOM&#39;</span><span class="p">,</span><span class="s1">&#39;HOM&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># match with gas</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AELHOM&#39;</span><span class="p">,</span><span class="s1">&#39;ELHOM&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># match with gas</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AOP3&#39;</span><span class="p">,</span><span class="s1">&#39;OP3&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># match with gas</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ATRPN&#39;</span><span class="p">,</span><span class="s1">&#39;TRPN&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># match with gas</span>
    <span class="n">dfae</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfae</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;AHONIT&#39;</span><span class="p">,</span><span class="s1">&#39;HONIT&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># match with gas</span>

    <span class="c1">###########################################</span>
    <span class="c1"># merge and add g (gas) or p (particle) suffix and do molec wt check</span>
    <span class="n">dfgc</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfgc</span><span class="p">,</span><span class="n">dfae</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;Species&quot;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span><span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_g&quot;</span><span class="p">,</span><span class="s2">&quot;_p&quot;</span><span class="p">))</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;chckmw&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;MOLWT_g&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;MOLWT_p&#39;</span><span class="p">]</span> <span class="c1"># gas and particle molecular weights should match</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfgc</span><span class="p">[</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;chckmw&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;gas and particle molecular weights have an inconsistency&lt;&lt;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">dfgc</span><span class="p">[</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;chckmw&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;gas and particle molecular weights match&lt;&lt;&quot;</span><span class="p">)</span>

    <span class="c1">###########################################</span>
    <span class="c1"># bring in descriptions</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">inputfiledir</span><span class="p">,</span> <span class="n">mech</span><span class="o">+</span><span class="s1">&#39;_speciesdescription.csv&#39;</span><span class="p">)</span>
    <span class="n">dfdesc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">dfdesc</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="n">dfdesc</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfdesc</span><span class="p">[</span><span class="s1">&#39;Species&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfdesc</span><span class="o">.</span><span class="n">Species</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># need to remove spaces from species names</span>
    <span class="n">dfgc</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfgc</span><span class="p">,</span><span class="n">dfdesc</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
    <span class="c1"># warning if no matching species description</span>
    <span class="k">if</span> <span class="n">dfgc</span><span class="p">[</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">size</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">spc</span> <span class="ow">in</span> <span class="n">dfgc</span><span class="p">[</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()][</span><span class="s1">&#39;Species&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: </span><span class="si">{</span><span class="n">spc</span><span class="si">}</span><span class="s1"> species description is missing&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Check </span><span class="si">{</span><span class="n">mech</span><span class="si">}</span><span class="s1">_speciesdescription.csv for missing species descriptions&#39;</span><span class="p">)</span>

    <span class="c1">###########################################</span>
    <span class="c1"># Organize data sort alphabetical, take GC.nml value first</span>
    <span class="n">dfgc</span> <span class="o">=</span> <span class="n">dfgc</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Species&quot;</span><span class="p">)</span> <span class="c1"># sort alphabetical</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s2">&quot;Phase&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s2">&quot;PhaseG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="n">dfgc</span><span class="p">[</span><span class="s2">&quot;PhaseP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Molecular Weight (g/mol)&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;MOLWT_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;MOLWT_p&#39;</span><span class="p">])</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Explicit/Lumped&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;ExplicitorLumped_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;ExplicitorLumped_p&#39;</span><span class="p">])</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Representative&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;!RepCmp_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;!RepCmp_p&#39;</span><span class="p">])</span> 
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;Representative&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">Representative</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;DTXSID_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;DTXSID_p&#39;</span><span class="p">])</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> 
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;SMILES_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;SMILES_p&#39;</span><span class="p">])</span> 
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
    <span class="c1"># Diagnose stable species based on them being transported in gas or aerosol</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;St&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;TRNS_g&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;TRNS_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;St&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;St&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;Yes&#39;</span><span class="p">)</span>
    <span class="n">dfgc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;St&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Stable&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Yes&#39;</span>
    <span class="n">dfgc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfgc</span><span class="p">[</span><span class="s1">&#39;St&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Stable&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;No&#39;</span>

    <span class="k">return</span> <span class="n">dfgc</span>


<span class="n">codedir</span> <span class="o">=</span> <span class="s1">&#39;/work/MOD3DEV/tskipper/cracmm_hcho/python_RHEL8/mcm_cracmm_speciation/cracmm2_metadata/code&#39;</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">codedir</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

<span class="n">mech</span><span class="o">=</span><span class="s1">&#39;cracmm2&#39;</span>
<span class="n">dfgc</span><span class="o">=</span><span class="n">prep_metadata</span><span class="p">(</span><span class="n">mech</span><span class="p">)</span>

<span class="c1">###########################################</span>
<span class="c1"># Write out Markdown for CMAQ github</span>
<span class="c1">###########################################</span>
<span class="n">dfmarkdown</span> <span class="o">=</span> <span class="n">dfgc</span><span class="p">[[</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span><span class="s1">&#39;Description&#39;</span><span class="p">,</span><span class="s1">&#39;Phase&#39;</span><span class="p">,</span><span class="s1">&#39;Molecular Weight (g/mol)&#39;</span><span class="p">,</span><span class="s1">&#39;Explicit/Lumped&#39;</span><span class="p">,</span><span class="s1">&#39;Representative&#39;</span><span class="p">,</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">,</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span><span class="s1">&#39;\[&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span><span class="s1">&#39;\]&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;\(&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;\)&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="o">.</span><span class="n">SMILES</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#for i in range(len(dfmarkdown)):</span>
<span class="c1">#  if len(dfmarkdown.DTXSID.iloc[i])&gt;5 :</span>
<span class="c1">#      dfmarkdown.SMILES.iloc[i]=&#39;[&#39;+ dfmarkdown.SMILES.iloc[i] + &#39;](https://comptox.epa.gov/dashboard/chemical/details/&#39; + dfmarkdown.DTXSID.iloc[i] + &#39;)&#39;</span>
<span class="c1">#smilestolink = dfmarkdown.DTXSID.str.len()&gt;5</span>
<span class="n">dfmarkdown</span><span class="o">.</span><span class="n">SMILES</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">DTXSID</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;[&#39;</span><span class="o">+</span> <span class="n">dfmarkdown</span><span class="o">.</span><span class="n">SMILES</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">DTXSID</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="o">+</span>  \
    <span class="s1">&#39;(https://comptox.epa.gov/dashboard/chemical/details/&#39;</span><span class="o">+</span>  \
    <span class="n">dfmarkdown</span><span class="o">.</span><span class="n">DTXSID</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">DTXSID</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
<span class="n">dfmarkdown</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">headerline</span> <span class="o">=</span> <span class="s1">&#39; &lt;sub&gt;Species&lt;/sub&gt; | &lt;sub&gt;Description&lt;/sub&gt; | &lt;sub&gt;Phase&lt;/sub&gt; | &lt;sub&gt;Molecular Weight (g/mol)&lt;/sub&gt; | &lt;sub&gt;Explicit/ Lumped&lt;/sub&gt; | &lt;sub&gt;Representative Structure&lt;/sub&gt; | &lt;sub&gt;SMILES&lt;/sub&gt; &#39;</span>
<span class="n">firstmarkdownline</span> <span class="o">=</span> <span class="s2">&quot;Gas (G) and particle (P) species from the namelists. SMILES link to representative structures in the EPA Chemicals Dashboard (if available).&quot;</span>
<span class="n">secondmarkdownline</span> <span class="o">=</span> <span class="s2">&quot;Note that for each particulate species in CMAQ, a letter will be appended to the name to designate the size, or mode, of the aerosol being represented: I = Aitken mode, J = Accumulation mode, K = Coarse mode. Prepending of a species with a V or A in CMAQ or the chemical mechanism files indicates the species resides in the gas or particulate phase. &quot;</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Representative&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfgc</span><span class="o">.</span><span class="n">Representative</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ug/m3&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;#956;g m&lt;sup&gt;-3&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;log10C&#39;</span><span class="p">,</span><span class="s1">&#39;log&lt;sub&gt;10&lt;/sub&gt;C&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;kOH&#39;</span><span class="p">,</span><span class="s1">&#39;k&lt;sub&gt;OH&lt;/sub&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cm3&#39;</span><span class="p">,</span><span class="s1">&#39;cm&lt;sup&gt;3&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s-1&#39;</span><span class="p">,</span><span class="s1">&#39;s&lt;sup&gt;-1&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10-10&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;-10&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10-11&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;-11&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10-12&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;-12&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10-13&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;-13&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10-14&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;-14&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10-2&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;-2&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10-1&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;-1&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10+1&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;+1&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10+2&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;+2&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10+3&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;+3&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10+4&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;+4&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10+5&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;+5&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfmarkdown</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dfmarkdown</span><span class="o">.</span><span class="n">Description</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;10+6&#39;</span><span class="p">,</span><span class="s1">&#39;10&lt;sup&gt;+6&lt;/sup&gt;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">outputfiledir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="n">mdfile</span> <span class="o">=</span> <span class="n">mech</span><span class="o">+</span><span class="s1">&#39;_species_table.md&#39;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">outputfiledir</span><span class="p">,</span> <span class="n">mdfile</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">firstmarkdownline</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">secondmarkdownline</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">headerline</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; ----- | ----- | ----- | ----- | ----- | ----- | ----- &#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">dfmarkdown</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#mdfile.write(lastmarkdownline)</span>
<span class="n">mdfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1">############# Metadata CSV</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfgc</span><span class="p">[[</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span><span class="s1">&#39;Description&#39;</span><span class="p">,</span><span class="s1">&#39;Phase&#39;</span><span class="p">,</span><span class="s1">&#39;Stable&#39;</span><span class="p">,</span><span class="s1">&#39;Molecular Weight (g/mol)&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Explicit/Lumped&#39;</span><span class="p">,</span><span class="s1">&#39;Representative&#39;</span><span class="p">,</span><span class="s1">&#39;SMILES&#39;</span><span class="p">,</span><span class="s1">&#39;DTXSID&#39;</span><span class="p">,</span><span class="s1">&#39;henryMatm&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;henryenthalpyK&#39;</span><span class="p">,</span><span class="s1">&#39;aerodensity&#39;</span><span class="p">,</span><span class="s1">&#39;aerokappa&#39;</span><span class="p">,</span><span class="s1">&#39;oacstar&#39;</span><span class="p">,</span><span class="s1">&#39;oaenthalpy&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;oaomoc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">dfmetadata</span><span class="o">.</span><span class="n">aerokappa</span><span class="p">[</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">aerokappa</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span>
<span class="n">dfmetadata</span><span class="o">.</span><span class="n">DTXSID</span><span class="p">[</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">DTXSID</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;henryMatm&#39;</span><span class="p">:</span><span class="s1">&#39;H Law (M/atm)&#39;</span><span class="p">})</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;henryenthalpyK&#39;</span><span class="p">:</span><span class="s1">&#39;Enthalpy of solution (K)&#39;</span><span class="p">})</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;aerodensity&#39;</span><span class="p">:</span><span class="s1">&#39;Aerosol density (kg/m3)&#39;</span><span class="p">})</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;aerokappa&#39;</span><span class="p">:</span><span class="s1">&#39;Kappa_org&#39;</span><span class="p">})</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;oacstar&#39;</span><span class="p">:</span><span class="s1">&#39;C* (microg/m3)&#39;</span><span class="p">})</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;oaenthalpy&#39;</span><span class="p">:</span><span class="s1">&#39;Enthalpy of vaporization (J/mol)&#39;</span><span class="p">})</span>
<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;oaomoc&#39;</span><span class="p">:</span><span class="s1">&#39;OM to OC (g/g)&#39;</span><span class="p">})</span>

<span class="n">dfmetadata</span><span class="o">=</span><span class="n">dfmetadata</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;NA&#39;</span><span class="p">)</span>

<span class="n">metafile</span> <span class="o">=</span> <span class="n">mech</span><span class="o">+</span><span class="s1">&#39;_metadata.csv&#39;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">outputfiledir</span><span class="p">,</span> <span class="n">metafile</span><span class="p">)</span>
<span class="c1">#metafile= open(filename,&#39;w&#39;)</span>
<span class="n">dfmetadata</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="c1">#mdfile.close()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;gas and particle molecular weights match&lt;&lt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_32466/2471386039.py:229: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  dfmarkdown.SMILES.fillna(&#39;&#39;,inplace=True)
/tmp/ipykernel_32466/2471386039.py:234: FutureWarning: ChainedAssignmentError: behaviour will change in pandas 3.0!
You are setting values through chained assignment. Currently this works in certain cases, but when using Copy-on-Write (which will become the default behaviour in pandas 3.0) this will never work to update the original DataFrame or Series, because the intermediate object on which we are setting values will behave as a copy.
A typical example is when you are setting values in a column of a DataFrame, like:

df[&quot;col&quot;][row_indexer] = value

Use `df.loc[row_indexer, &quot;col&quot;] = values` instead, to perform the assignment in a single step and ensure this keeps updating the original `df`.

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy

  dfmarkdown.SMILES.loc[dfmarkdown.DTXSID.str.len()&gt;5]=&#39;[&#39;+ dfmarkdown.SMILES.loc[dfmarkdown.DTXSID.str.len()&gt;5] + &#39;]&#39;+  \
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">PermissionError</span><span class="g g-Whitespace">                           </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">264</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span> <span class="n">mdfile</span> <span class="o">=</span> <span class="n">mech</span><span class="o">+</span><span class="s1">&#39;_species_table.md&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">outputfiledir</span><span class="p">,</span> <span class="n">mdfile</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">264</span> <span class="n">mdfile</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">265</span> <span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">firstmarkdownline</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span> <span class="n">mdfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nn">File ~/docs_env/lib64/python3.11/site-packages/IPython/core/interactiveshell.py:324,</span> in <span class="ni">_modified_open</span><span class="nt">(file, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}:</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span>         <span class="sa">f</span><span class="s2">&quot;IPython won&#39;t let you open fd=</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2"> by default &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span>         <span class="s2">&quot;as it is likely to crash IPython. If you know what you are doing, &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>         <span class="s2">&quot;you can use builtins&#39; open.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">324</span> <span class="k">return</span> <span class="n">io_open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="ne">PermissionError</span>: [Errno 13] Permission denied: &#39;/work/MOD3DEV/tskipper/cracmm_hcho/python_RHEL8/mcm_cracmm_speciation/cracmm2_metadata/code/../output/cracmm2_species_table.md&#39;
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="BEISMEGAN_biogenicmapping2cracmm.html" class="btn btn-neutral float-left" title="Map BEIS and MEGAN species to CRACMM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SPECIATE_map2cracmm.html" class="btn btn-neutral float-right" title="Map SPECIATE species to CRACMM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, The CRACMM Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>