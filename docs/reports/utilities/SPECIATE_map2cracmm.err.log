Traceback (most recent call last):
  File "/home/mpye/docs_env/lib64/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/mpye/docs_env/lib64/python3.11/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mpye/docs_env/lib64/python3.11/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/mpye/docs_env/lib64/python3.11/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/mpye/docs_env/lib64/python3.11/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/mpye/docs_env/lib64/python3.11/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
smiles_k = 'Smiles Notation'
koh_k    = 'ATMOSPHERIC_HYDROXYLATION_RATE_(AOH)_CM3/MOLECULE*SEC_OPERA'
cstar_k  = 'log10Cstar_ugm3'
df['CRACMM2'] = df.apply(lambda x: cracmm2.get_cracmm_roc(x[smiles_k], x[koh_k], x[cstar_k]), axis=1)

# check if any species mappings changed
print(df.keys())
df_checkmatch = df.eval(f'match = {orig_map_colname}==CRACMM2')
show_cols = ['SPECIES_NAME',orig_map_colname,'CRACMM2']
if len(df_checkmatch[df_checkmatch.match==False])>0:
    print(f'the species mappings below changed from {orig_map_colname}')
    display(df_checkmatch[show_cols][df_checkmatch.match==False])
else:
    print(f'all species matched {orig_map_colname} mapping')

# save output
df = df.drop(columns=[orig_map_colname, cstar_k])
df.to_csv(outputdir+'SPECIATEv5.2x_fromCRACMM.csv', **csvout_kw)
------------------

----- stdout -----
Index(['SPECIES_ID', 'CAS', 'CAS no hyphen', 'ALT_CAS', 'DSSTox_ID', 'SAROAD',
       'SRS ID', 'NonVOCTOG', 'PAMS', 'HAPS', 'SPECIES_NAME',
       'REPRESENTATIVE_COMPOUND_NAME', 'REPRESENTATIVE_COMPOUND_DSSTox_ID',
       'SYMBOL', 'SPEC_MW', 'NOTE', 'Molecular Formula',
       'OXYGEN_to_CARBON_RATIO', 'Smiles Notation', 'VP_Pascal_EPI',
       'VP_Pascal_UM', 'VP_Pascal_OPERA',
       'ATMOSPHERIC_HYDROXYLATION_RATE_(AOH)_CM3/MOLECULE*SEC_OPERA',
       'HENRYS_LAW_ATM-M3/MOLE_OPERA',
       'OCTANOL_AIR_PARTITION_COEFF_LOGKOA_OPERA',
       'OCTANOL_WATER_PARTITION_LOGP_OPERA', 'Duplicate_ID', 'REPCMPSCORE',
       'CRACMM1', 'CRACMM1', 'log10Cstar_ugm3', 'CRACMM2'],
      dtype='object')
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[8], line 8[0m
[1;32m      6[0m [38;5;66;03m# check if any species mappings changed[39;00m
[1;32m      7[0m [38;5;28mprint[39m(df[38;5;241m.[39mkeys())
[0;32m----> 8[0m df_checkmatch [38;5;241m=[39m [43mdf[49m[38;5;241;43m.[39;49m[43meval[49m[43m([49m[38;5;124;43mf[39;49m[38;5;124;43m'[39;49m[38;5;124;43mmatch = [39;49m[38;5;132;43;01m{[39;49;00m[43morig_map_colname[49m[38;5;132;43;01m}[39;49;00m[38;5;124;43m==CRACMM2[39;49m[38;5;124;43m'[39;49m[43m)[49m
[1;32m      9[0m show_cols [38;5;241m=[39m [[38;5;124m'[39m[38;5;124mSPECIES_NAME[39m[38;5;124m'[39m,orig_map_colname,[38;5;124m'[39m[38;5;124mCRACMM2[39m[38;5;124m'[39m]
[1;32m     10[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(df_checkmatch[df_checkmatch[38;5;241m.[39mmatch[38;5;241m==[39m[38;5;28;01mFalse[39;00m])[38;5;241m>[39m[38;5;241m0[39m:

File [0;32m~/docs_env/lib64/python3.11/site-packages/pandas/core/frame.py:4943[0m, in [0;36mDataFrame.eval[0;34m(self, expr, inplace, **kwargs)[0m
[1;32m   4941[0m kwargs[[38;5;124m"[39m[38;5;124mlevel[39m[38;5;124m"[39m] [38;5;241m=[39m kwargs[38;5;241m.[39mpop([38;5;124m"[39m[38;5;124mlevel[39m[38;5;124m"[39m, [38;5;241m0[39m) [38;5;241m+[39m [38;5;241m1[39m
[1;32m   4942[0m index_resolvers [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_index_resolvers()
[0;32m-> 4943[0m column_resolvers [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_get_cleaned_column_resolvers[49m[43m([49m[43m)[49m
[1;32m   4944[0m resolvers [38;5;241m=[39m column_resolvers, index_resolvers
[1;32m   4945[0m [38;5;28;01mif[39;00m [38;5;124m"[39m[38;5;124mtarget[39m[38;5;124m"[39m [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m kwargs:

File [0;32m~/docs_env/lib64/python3.11/site-packages/pandas/core/generic.py:659[0m, in [0;36mNDFrame._get_cleaned_column_resolvers[0;34m(self)[0m
[1;32m    656[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m, ABCSeries):
[1;32m    657[0m     [38;5;28;01mreturn[39;00m {clean_column_name([38;5;28mself[39m[38;5;241m.[39mname): [38;5;28mself[39m}
[0;32m--> 659[0m [38;5;28;01mreturn[39;00m [43m{[49m
[1;32m    660[0m [43m    [49m[43mclean_column_name[49m[43m([49m[43mk[49m[43m)[49m[43m:[49m[43m [49m[43mSeries[49m[43m([49m
[1;32m    661[0m [43m        [49m[43mv[49m[43m,[49m[43m [49m[43mcopy[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m[43m [49m[43mindex[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mindex[49m[43m,[49m[43m [49m[43mname[49m[38;5;241;43m=[39;49m[43mk[49m[43m,[49m[43m [49m[43mdtype[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdtypes[49m[43m[[49m[43mk[49m[43m][49m
[1;32m    662[0m [43m    [49m[43m)[49m[38;5;241;43m.[39;49m[43m__finalize__[49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m
[1;32m    663[0m [43m    [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43mk[49m[43m,[49m[43m [49m[43mv[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[38;5;28;43mzip[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcolumns[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_iter_column_arrays[49m[43m([49m[43m)[49m[43m)[49m
[1;32m    664[0m [43m    [49m[38;5;28;43;01mif[39;49;00m[43m [49m[38;5;129;43;01mnot[39;49;00m[43m [49m[38;5;28;43misinstance[39;49m[43m([49m[43mk[49m[43m,[49m[43m [49m[38;5;28;43mint[39;49m[43m)[49m
[1;32m    665[0m [43m[49m[43m}[49m

File [0;32m~/docs_env/lib64/python3.11/site-packages/pandas/core/generic.py:660[0m, in [0;36m<dictcomp>[0;34m(.0)[0m
[1;32m    656[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m, ABCSeries):
[1;32m    657[0m     [38;5;28;01mreturn[39;00m {clean_column_name([38;5;28mself[39m[38;5;241m.[39mname): [38;5;28mself[39m}
[1;32m    659[0m [38;5;28;01mreturn[39;00m {
[0;32m--> 660[0m     clean_column_name(k): [43mSeries[49m[43m([49m
[1;32m    661[0m [43m        [49m[43mv[49m[43m,[49m[43m [49m[43mcopy[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m[43m [49m[43mindex[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mindex[49m[43m,[49m[43m [49m[43mname[49m[38;5;241;43m=[39;49m[43mk[49m[43m,[49m[43m [49m[43mdtype[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdtypes[49m[43m[[49m[43mk[49m[43m][49m
[1;32m    662[0m [43m    [49m[43m)[49m[38;5;241m.[39m__finalize__([38;5;28mself[39m)
[1;32m    663[0m     [38;5;28;01mfor[39;00m k, v [38;5;129;01min[39;00m [38;5;28mzip[39m([38;5;28mself[39m[38;5;241m.[39mcolumns, [38;5;28mself[39m[38;5;241m.[39m_iter_column_arrays())
[1;32m    664[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(k, [38;5;28mint[39m)
[1;32m    665[0m }

File [0;32m~/docs_env/lib64/python3.11/site-packages/pandas/core/series.py:493[0m, in [0;36mSeries.__init__[0;34m(self, data, index, dtype, name, copy, fastpath)[0m
[1;32m    490[0m     index [38;5;241m=[39m ensure_index(index)
[1;32m    492[0m [38;5;28;01mif[39;00m dtype [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 493[0m     dtype [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_validate_dtype[49m[43m([49m[43mdtype[49m[43m)[49m
[1;32m    495[0m [38;5;28;01mif[39;00m data [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    496[0m     index [38;5;241m=[39m index [38;5;28;01mif[39;00m index [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m default_index([38;5;241m0[39m)

File [0;32m~/docs_env/lib64/python3.11/site-packages/pandas/core/generic.py:516[0m, in [0;36mNDFrame._validate_dtype[0;34m(cls, dtype)[0m
[1;32m    514[0m [38;5;250m[39m[38;5;124;03m"""validate the passed dtype"""[39;00m
[1;32m    515[0m [38;5;28;01mif[39;00m dtype [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 516[0m     dtype [38;5;241m=[39m [43mpandas_dtype[49m[43m([49m[43mdtype[49m[43m)[49m
[1;32m    518[0m     [38;5;66;03m# a compound dtype[39;00m
[1;32m    519[0m     [38;5;28;01mif[39;00m dtype[38;5;241m.[39mkind [38;5;241m==[39m [38;5;124m"[39m[38;5;124mV[39m[38;5;124m"[39m:

File [0;32m~/docs_env/lib64/python3.11/site-packages/pandas/core/dtypes/common.py:1666[0m, in [0;36mpandas_dtype[0;34m(dtype)[0m
[1;32m   1664[0m     [38;5;28;01mreturn[39;00m npdtype
[1;32m   1665[0m [38;5;28;01melif[39;00m npdtype[38;5;241m.[39mkind [38;5;241m==[39m [38;5;124m"[39m[38;5;124mO[39m[38;5;124m"[39m:
[0;32m-> 1666[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mdtype [39m[38;5;124m'[39m[38;5;132;01m{[39;00mdtype[38;5;132;01m}[39;00m[38;5;124m'[39m[38;5;124m not understood[39m[38;5;124m"[39m)
[1;32m   1668[0m [38;5;28;01mreturn[39;00m npdtype

[0;31mTypeError[0m: dtype 'CRACMM1    object
CRACMM1    object
dtype: object' not understood

